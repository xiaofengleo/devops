sudo: required
services:
- docker
language: python
python:
- '3.5'
before_install:
- docker version
- docker info
install:
- pip install nose
- pip install Flask-Testing
- npm install newman
- pip install -r requirements.txt
before_script:
- node --version
- npm --version
- node_modules/.bin/newman --version
script:
- nosetests
- docker build -t liaoxiaofeng/devops-docker:swagger_server .
- docker run --name example_api -d -t -p 127.0.0.1:8080:8080 liaoxiaofeng/devops-docker:swagger_server
- docker ps
- count=0 && until $(curl --output /dev/null --silent --head --fail http://localhost:8080);
  do printf '.' && sleep 3 && count=$((count+1)) && if [ $count -gt 5 ]; then break;
  fi; done
after_success:
- docker login -u $DOCKER_USER -p $DOCKER_PASS
- docker tag liaoxiaofeng/devops-docker:swagger_server liaoxiaofeng/devops-docker:swagger_server
- docker push liaoxiaofeng/devops-docker:swagger_server
env:
  global:
  - secure: KleZU5Dh8/b+NEQeUbEgwa0pU78lgG72yjq22QiyoDX40Os5MlOcirtHvqL+EVewPridLUfRaLncm8Xwy1enyhQSrruwEbx7+6fz4lMEFkAv9LLsE3jsZk3WYRbwqlQgmJ+ZVAbTd06OSN9s79XpsVKC8Gc1ngaGPZK9hWvwV8u0CIWNLDKLBo/bDV2nzY/Sr9gpbgg9HNwJMXeaVbvcI2yA+6PZAe0/BxvnslJqjG5vhIHT4BL5zJcbnQnTbSvgjjcPUWG1afj0DWyYsRvGOLqPwhk2R3cprtBYqOXNvF0xnSEjtD/etdOwwwfn0T6dOSsiRRdpQPbxnSbnEW+ePv/iVYJVucFT+1aqWC/kDuBDFkJnqmM7JbiPFohzV2dir1oY0qmqf1NJMwKJeccJH/4cwjkPVOoDXcFpgwM3rvEsZgvjwq2YQEFVMchtq/7MFvrT9/wWR0/8ny3FkvPIygMWaBs2j25NvJappxX39CGEp3tPhHpAWdluyurOh61WOJR08aCS0Pm8gYd63jIRM6XUaiBFpgjspaGy5ooJDzFRv90BY/kfsVyNc2aadeeO8q5gRM1h/CONnBa3M0B7CJXsAFbuy+p1hzCMdtCm+rbKKCjqmlY72E0kcgrUfWjKEVo9mgO2yFWmwD5JIXTv3AY9kaAB+tBKWClEqABmeG4=
  - secure: uqrGjQp9CkVygoafFpE7vfLKJJynVXh0qka9BHTmcTdEQ39DEqvOJGA85AWLz2dQu13U+Wa8qYFYeJycqFILEzzi29S6hFT3POtsTq6qYKNBdQXmpVqqp3wr/M7UAPMb32X5CjUgswbzbEPa38lgN0xmauVtMVdsWFDQhmktic+bw5GHziJ74bsLxAK1jfZEA+3H2qlosuxc0O92B9IwFTjsh1uU0SDmL11mW7jnRlfo0JPz/lMzQ4bXBorqjgHdUgkvmLLECxVZhmyrSfRv5j3kDX7WcR0UjNkllrkIWo7f1QL/Ovm9lgRAVRLe7v+aLrKT9MUANjYnrpdpIhP5gVa/1KrQ2ukkymQwaSrLTzxXg75+qtZfW0yMgtrWxHWLu8tr3kaB9jTnjn1PSeO1IlWsBAue8X0kKDRxa5jxVCspT4Yz1/dyyb1xLmMhSUHyabc/V7YBoJi2672r5H2TW8ClFLQ0Y3NwSgjedsUuJ5PYCAiLdFGyIjkZfwZeyPKau79TTlriYy8MdtuOqXojlyYOr6qyPUMrUJ7EM0A47L/um+PpAZ4yrUV5bGdwUXZzDA9O+PcQxQ1YHTGS9vw65f5r6xIO864Gi0NdKNPB09/XjIphKCIO97k6wE6ix44noxYs/EwTQ0lQ4WxNiwTFWEOXcca+59wUn/ntryD36VU=
